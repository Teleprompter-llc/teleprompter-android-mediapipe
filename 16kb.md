MediaPipe AAR Build Summary

Problem Identification
•  You discovered that the native libraries in the built AAR had alignment issues
•  Analysis showed 3 unaligned libraries that needed 16KB alignment for arm64-v8a architecture:
◦  libmediapipe_jni.so (arm64-v8a): 4096 bytes (UNALIGNED)
◦  libopencv_java4.so (armeabi-v7a): 4096 bytes (UNALIGNED)
◦  libmediapipe_jni.so (armeabi-v7a): 4096 bytes (UNALIGNED)

Solution Implemented
1. Analyzed the alignment using the verification script e.sh:
bash
2. Updated build_aar.sh to include 16KB page alignment linker flags:
◦  Added: --linkopt=-Wl,-z,max-page-size=16384
◦  Added: --linkopt=-Wl,-z,common-page-size=16384
3. Build configuration in build_aar.sh:
◦  Python version: 3.11
◦  Optimization: -c opt --strip=ALWAYS
◦  Target ABIs: arm64-v8a,armeabi-v7a
◦  Compiler optimizations: -Oz, -ffunction-sections, -fdata-sections
◦  16KB alignment flags for Android 15+ compatibility

Result
•  Built AAR file: selfie_segmentation_gpu_aar.aar (26MB)
•  Location: /root/.cache/bazel/_bazel_root/.../selfie_segmentation_gpu_aar.aar
•  Extracted to host machine using docker cp command
